<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mesin Capit Pro</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { margin: 0; padding: 0; background: #000 no-repeat center center fixed; background-size: cover; font-family: sans-serif; height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .box { background: rgba(0,0,0,0.7); padding: 25px; border-radius: 20px; border: 2px solid gold; text-align: center; width: 320px; position: relative; }
        .machine { width: 100%; height: 200px; background: rgba(255,255,255,0.1); border-radius: 10px; position: relative; margin-bottom: 20px; overflow: hidden; }
        #claw { width: 60px; position: absolute; top: -5px; left: 50%; transform: translateX(-50%); transition: 2s; }
        #doll { width: 80px; position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); }
        h1 { margin: 5px 0; font-size: 1.5rem; color: #fff; }
        .sub { color: gold; font-size: 0.8rem; margin-bottom: 15px; }
        input { width: 100%; padding: 12px; border-radius: 10px; border: none; margin-bottom: 10px; text-align: center; box-sizing: border-box; }
        button { width: 100%; padding: 12px; border-radius: 10px; border: none; background: gold; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body id="web-bg">

    <div class="box">
        <h1 id="web-title">LOADING...</h1>
        <p class="sub" id="web-sub">TUNGGU SEBENTAR</p>
        
        <div class="machine">
            <img id="web-claw" src="" alt="">
            <img id="web-doll" src="" alt="">
        </div>

        <input type="text" id="coupon" placeholder="MASUKKAN KODE">
        <button onclick="play()" id="web-btn">START</button>
    </div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCQG-NkD9rLLtIFOXBCfdNZ_yFRfx6LPrg",
        authDomain: "mesin-capit-bd535.firebaseapp.com",
        databaseURL: "https://mesin-capit-bd535-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "mesin-capit-bd535",
        storageBucket: "mesin-capit-bd535.firebasestorage.app",
        messagingSenderId: "978657704206",
        appId: "1:978657704206:web:ee29d7ce6007d3fed93f5f"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    db.ref('config').on('value', (s) => {
        const c = s.val();
        if(c){
            document.getElementById('web-title').innerText = c.title || "Mesin Capit";
            document.getElementById('web-sub').innerText = c.sub || "Silakan Main";
            document.getElementById('web-btn').innerText = c.btn || "START";
            if(c.bg) document.getElementById('web-bg').style.backgroundImage = `url('${c.bg}')`;
            if(c.claw) document.getElementById('web-claw').src = c.claw;
            if(c.doll) document.getElementById('web-doll').src = c.doll;
        }
    });

    function play() {
        const code = document.getElementById('coupon').value.toUpperCase();
        const claw = document.getElementById('claw');
        
        // Animasi Capit Turun
        document.getElementById('web-claw').style.top = "100px";

        setTimeout(() => {
            db.ref('kupon/' + code).once('value').then((snap) => {
                const d = snap.val();
                if(d && d.status === "aktif") {
                    Swal.fire("ðŸŽ‰ BERHASIL!", "Dapet: " + d.hadiah, "success");
                    db.ref('kupon/' + code).update({status: "terpakai"});
                } else {
                    Swal.fire("ZONK!", "Kode Salah/Expired", "error");
                }
                document.getElementById('web-claw').style.top = "-5px";
            });
        }, 2000);
    }
</script>
</body>
</html>
